<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="utf-8" />

  <!-- Typekit (senin istediğin) -->
  <link rel="stylesheet" href="https://use.typekit.net/mhd1hjd.css">

  <style>
    @page {
      size: A4;
      margin: 18mm 8mm 20mm 8mm; /* VF’deki gibi sıkı margin */
    }

    html, body {
      margin: 0;
      padding: 0;
      /* Typekit font adı orgdan orga değişebilir; bu yüzden geniş fallback */
      font-family: "trajan-pro-3","trajan-pro","Trajan Pro","Arial Unicode MS", Arial, "Helvetica Neue", sans-serif;
      font-size: 10pt;
      color: #000;
      -webkit-print-color-adjust: exact;
      print-color-adjust: exact;
    }

    /* Header fixed: Puppeteer’da @top-center/running(header) birebir çalışmaz.
       O yüzden fixed header + content padding yöntemi. */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      height: 95mm; /* header yüksekliği */
      text-align: center;
      padding-top: 10px;
      box-sizing: border-box;
    }

    .snocLogo {
      width: 250px;
      height: 80px;
      display: block;
      margin: 0 auto;
      object-fit: contain;
    }

    .header-text {
      font-size: 7pt;
      font-weight: normal;
      color: #333;
      margin-top: 5px;
      margin-bottom: 0;
      line-height: 1.35;
    }

    /* İçerik header'ın altından başlasın */
    .content {
      padding-top: 100mm; /* header yüksekliğinden biraz fazla */
    }

    /* Başlık */
    .main-title {
      text-align: center;
      width: 100%;
      margin-top: 8mm;
      margin-bottom: 4mm;
    }

    .main-title span {
      font-size: 15pt;
      font-weight: bold;
      border-bottom: 1px solid #000;
      padding-bottom: 2px;
    }

    /* Üst bilgi tablo */
    .top-info {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 4mm;
      font-size: 8pt;
    }
    .top-info td {
      vertical-align: top;
      padding: 0;
    }

    /* Quote line table */
    table.quote-lines-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 8mm;
      font-size: 7pt;
    }

    table.quote-lines-table th {
      border: 1px solid #fff;
      text-align: center;
      background-color: #bfbfbf;
      padding: 4px 3px;
      font-weight: bold;
    }

    table.quote-lines-table td {
      border: 1px solid #fff;
      text-align: center;
      font-size: 6pt;
      padding: 4px 3px;
      vertical-align: top;
    }

    tr.data-row:nth-child(even) { background-color: #f5f5f5; }
    tr.data-row:nth-child(odd)  { background-color: #ffffff; }

    td.product-desc {
      text-align: left;
    }

    tr.data-row {
      page-break-inside: avoid;
      break-inside: avoid;
    }

    .product-image {
      width: 120px;
      height: 80px;
      max-width: 120px;
      max-height: 80px;
      object-fit: contain;
      display: block;
      margin: 0 auto;
    }

    /* Her 5 satırda page break */
    .page-break-row td {
      page-break-after: always;
      height: 1px;
      padding: 0;
      border: none;
      background: transparent;
    }

    /* Totals block */
    .totals-wrap {
      page-break-inside: avoid;
      break-inside: avoid;
      margin-top: 10mm;
    }

    .totals-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 7pt;
    }

    .totals-table td {
      padding: 2px 0;
    }

    .line-top {
      border-top: 1px solid #000;
      width: 100%;
      margin-bottom: 8px;
    }

    .line-bottom {
      border-bottom: 1px solid #000;
      width: 100%;
      margin-top: 8px;
    }

    /* Notes */
    .notes {
      page-break-inside: avoid;
      break-inside: avoid;
      margin-top: 6mm;
      font-size: 6pt;
      line-height: 1.35;
    }

    .notes table {
      border-collapse: collapse;
      width: 100%;
    }

    .notes td {
      padding: 2px 0;
      text-align: left;
    }

    /* Bank info page */
    .page-break-after {
      page-break-after: always;
      break-after: page;
      height: 1px;
    }

    .section-title {
      text-align: center;
      width: 100%;
      margin-top: 20mm;
      margin-bottom: 12mm;
    }

    .section-title span {
      font-size: 11pt;
      font-weight: bold;
      border-bottom: 1px solid #000;
      padding-bottom: 2px;
    }

    .bank-table {
      font-size: 10pt;
      margin-left: 5cm;
      margin-bottom: 2cm;
      border-collapse: collapse;
    }

    .bank-table td {
      padding: 2px 0;
    }

    .bank-label {
      letter-spacing: 10px;
      white-space: nowrap;
    }
  </style>
</head>

<body>
  <!-- HEADER -->
  <div class="header">
    {{#if logoDataUri}}
      <img class="snocLogo" src="{{logoDataUri}}" alt="Logo" />
    {{/if}}

    <div class="header-text">
      EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD. ŞTİ.<br/>
      NECİP FAZIL BULVARI NO:46/A Y.DUDULLU / ÜMRANİYE / İSTANBUL/TÜRKİYE <br/>
      TEL: +90 (850) 800 64 64
    </div>
  </div>

  <div class="content">
    <!-- BAŞLIK -->
    <div class="main-title">
      <span>{{title}}</span>
    </div>

    <!-- ÜST BİLGİ -->
    <table class="top-info">
      <tr>
        <td style="width:50%; text-align:left; vertical-align: bottom; padding-bottom:1px;">
          <div style="padding-top: 6mm;">SAYIN: {{customerName}}</div>
        </td>

        <td style="width:50%; text-align:right;">
          <div>{{todayFmt}}</div>
          <div>İLETİŞİM: {{ownerName}}</div>
          <div>E-MAIL: {{ownerEmail}}</div>
        </td>
      </tr>
    </table>

    <!-- LINES TABLE -->
    <table class="quote-lines-table">
      <tr>
        <th style="width:16%;">FOTOĞRAF</th>
        <th style="width:32%;">AÇIKLAMA</th>
        <th style="width:8%;">ADET</th>
        <th style="width:13%;">BİRİM FİYATI</th>
        <th style="width:10%;">TOPLAM</th>
        <th style="width:10%; white-space: nowrap;">İNDİRİMLİ TUTAR</th>
        <th style="width:8%; white-space: nowrap;">STOK DURUMU</th>
      </tr>

      {{#each lines}}
        <tr class="data-row">
          <!-- FOTO -->
          <td>
            {{#if hasImage}}
              <img class="product-image" src="{{imageDataUri}}" alt="Ürün" />
            {{/if}}
          </td>

          <!-- AÇIKLAMA -->
          <td class="product-desc">
            <div>{{productName}}</div>
            {{#if usageArea}}
              <div>{{usageArea}}</div>
            {{/if}}

            {{#if description}}
              <div style="margin-top: 2mm; font-size: 7pt;">{{description}}</div>
            {{/if}}

            <div style="margin-top: 3mm;">{{dimension}}</div>
          </td>

          <!-- ADET -->
          <td>{{qtyFmt}}</td>

          <!-- BİRİM -->
          <td>{{unitPriceFmt}}</td>

          <!-- TOPLAM -->
          <td>{{subTotalFmt}}</td>

          <!-- İNDİRİMLİ -->
          <td>{{totalPriceFmt}}</td>

          <!-- STOK -->
          <td>{{stockStatus}}</td>
        </tr>

        {{#if pageBreakAfter}}
          <tr class="page-break-row">
            <td colspan="7"></td>
          </tr>
        {{/if}}
      {{/each}}
    </table>

    <!-- TOTALS -->
    <div class="totals-wrap">
      <div class="line-top"></div>
      <table class="totals-table">
        <tr>
          <td style="width:60%;">&nbsp;</td>
          <td style="width:20%; text-align:left; font-weight:bold;">TOPLAM</td>
          <td style="width:20%; text-align:right;">{{totalAmountFmt}} ₺</td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td style="text-align:left; font-weight:bold;">TOPLAM İNDİRİM</td>
          <td style="text-align:right;">{{discountAmountFmt}} ₺</td>
        </tr>
        <tr>
          <td>&nbsp;</td>
          <td style="text-align:left; font-weight:bold;">GENEL TOPLAM</td>
          <td style="text-align:right; font-weight:bold;">{{grandTotalFmt}} ₺</td>
        </tr>
      </table>
      <div class="line-bottom"></div>
    </div>

    <!-- NOTLAR -->
    <div class="notes">
      <table>
        <tr><td>- TEKLİFTE KULLANILAN GÖRSELLER TANITIM AMAÇLI OLUP AÇIKLAMALAR DİKKATE ALINMALIDIR</td></tr>
        <tr><td>- {{notes.payment}}</td></tr>
        <tr><td>- {{notes.delivery}}</td></tr>
        <tr><td>- {{notes.kdv}}</td></tr>
        <tr><td>- {{notes.validity}}</td></tr>
      </table>
    </div>

    <div class="page-break-after"></div>

    <!-- BANKA -->
    <div class="section-title">
      <span>HESAP BİLGİLERİMİZ</span>
    </div>

    <table class="bank-table">
      <tr>
        <td class="bank-label">BANKA ADI</td><td>&nbsp;</td><td>GARANTİ BANKASI</td>
      </tr>
      <tr>
        <td>HESAP BİLGİSİ</td><td>&nbsp;</td><td>EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD.ŞTİ</td>
      </tr>
      <tr>
        <td>HESAP NUMARASI</td><td>&nbsp;</td><td>IBAN: TR90 0006 2001 6690 0006 2978 90</td>
      </tr>
    </table>

    <table class="bank-table">
      <tr>
        <td class="bank-label">BANKA ADI</td><td>&nbsp;</td><td>AKBANK</td>
      </tr>
      <tr>
        <td>HESAP BİLGİSİ</td><td>&nbsp;</td><td>EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD.ŞTİ</td>
      </tr>
      <tr>
        <td>HESAP NUMARASI</td><td>&nbsp;</td><td>IBAN: TR84 0004 6006 2888 8000 1241 74</td>
      </tr>
    </table>

    <table class="bank-table">
      <tr>
        <td class="bank-label">BANKA ADI</td><td>&nbsp;</td><td>İŞ BANKASI</td>
      </tr>
      <tr>
        <td>HESAP BİLGİSİ</td><td>&nbsp;</td><td>EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD.ŞTİ</td>
      </tr>
      <tr>
        <td>HESAP NUMARASI</td><td>&nbsp;</td><td>IBAN: TR87 0006 4000 0011 2110 3359 72</td>
      </tr>
    </table>

    <table class="bank-table">
      <tr>
        <td class="bank-label">BANKA ADI</td><td>&nbsp;</td><td>QNB FİNANSBANK</td>
      </tr>
      <tr>
        <td>HESAP BİLGİSİ</td><td>&nbsp;</td><td>EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD.ŞTİ</td>
      </tr>
      <tr>
        <td>HESAP NUMARASI</td><td>&nbsp;</td><td>IBAN: TR62 0011 1000 0000 0061 6173 81</td>
      </tr>
    </table>

    <table class="bank-table" style="margin-bottom:0;">
      <tr>
        <td class="bank-label">BANKA ADI</td><td>&nbsp;</td><td>ZİRAAT BANKASI</td>
      </tr>
      <tr>
        <td>HESAP BİLGİSİ</td><td>&nbsp;</td><td>EKVATOR ISI MÜHENDİSLİK İNŞ. SAN. VE TİC. LTD.ŞTİ</td>
      </tr>
      <tr>
        <td>HESAP NUMARASI</td><td>&nbsp;</td><td>IBAN: TR19 0001 0021 8862 9823 6850 03</td>
      </tr>
    </table>
  </div>
</body>
</html>
